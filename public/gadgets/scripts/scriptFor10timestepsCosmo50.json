{
    "logicalRa": "scriptFor10Timesteps",
    "plan": {
        "type": "Sequence",
        "plans": [
            {
                "fragments": [
                    {
                        "operators": [
                            {
                                "opType": "DbQueryScan",
                                "opName": "Scan",
                                "opId": 1,
                                "schema": {
                                    "columnNames": [
                                        "nowGroup",
                                        "iOrder",
                                        "mass",
                                        "type",
                                        "timestep",
                                        "grp"
                                    ],
                                    "columnTypes": [
                                        "INT_TYPE",
                                        "INT_TYPE",
                                        "FLOAT_TYPE",
                                        "STRING_TYPE",
                                        "INT_TYPE",
                                        "INT_TYPE"
                                    ]
                                },
                                "sql": "SELECT p1.nowGroup, p2.iOrder, p2.mass, p2.type, 2 as timestep, p2.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot504Hash\" p2 WHERE p1.iOrder = p2.iOrder UNION SELECT  p1.nowGroup, p3.iOrder, p3.mass, p3.type, 3 as timestep, p3.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot480Hash\" p3 WHERE p1.iOrder = p3.iOrder UNION SELECT  p1.nowGroup, p4.iOrder, p4.mass, p4.type, 4 as timestep, p4.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot466Hash\" p4 WHERE p1.iOrder = p4.iOrder  UNION SELECT  p1.nowGroup, p5.iOrder, p5.mass, p5.type, 5 as timestep, p5.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot456Hash\" p5 WHERE p1.iOrder = p5.iOrder UNION SELECT  p1.nowGroup, p6.iOrder, p6.mass, p6.type, 6 as timestep, p6.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot455Hash\" p6 WHERE p1.iOrder = p6.iOrder UNION SELECT  p1.nowGroup, p7.iOrder, p7.mass, p7.type, 7 as timestep, p7.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot432Hash\" p7 WHERE p1.iOrder = p7.iOrder UNION SELECT  p1.nowGroup, p8.iOrder, p8.mass, p8.type, 8 as timestep, p8.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot408Hash\" p8 WHERE p1.iOrder = p8.iOrder UNION SELECT  p1.nowGroup, p9.iOrder, p9.mass, p9.type, 9 as timestep, p9.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot406Hash\" p9 WHERE p1.iOrder = p9.iOrder UNION SELECT  p1.nowGroup, p10.iOrder, p10.mass, p10.type, 10 as timestep, p10.grp FROM \"astro mergerTreeCosmo50 broadcastParticlesOfInterest\" p1, \"astro cosmo50 snapshot384Hash\" p10 WHERE p1.iOrder = p10.iOrder;"
                            },
                            {
                                "argChild": 1,
                                "argOverwriteTable": true,
                                "opName": "Insert",
                                "opId": 2,
                                "opType": "DbInsert",
                                "relationKey": {
                                    "programName": "mergerTreeCosmo50",
                                    "relationName": "allTimestepsPOI",
                                    "userName": "astro"
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "fragments": [
                    {
                        "workers": [
                            2
                        ],
                        "operators": [
                            {
                                "opName": "MyriaScan(jortiz:testAstro:broadcastTest)",
                                "opId": 0,
                                "opType": "TableScan",
                                "relationKey": {
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro",
                                    "relationName": "broadcastParticlesOfInterest"
                                }
                            },
                            {
                                "argChild": 0,
                                "opId": 189,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "operators": [
                            {
                                "argOperatorId": 189,
                                "opId": 190,
                                "opType": "ShuffleConsumer"
                            },
                            {
                                "argChild": 190,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "columnIdx": 0,
                                            "type": "VARIABLE"
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "columnIdx": 1,
                                            "type": "VARIABLE"
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "columnIdx": 2,
                                            "type": "VARIABLE"
                                        }
                                    },
                                    {
                                        "outputName": "type",
                                        "rootExpressionOperator": {
                                            "columnIdx": 3,
                                            "type": "VARIABLE"
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "valueType": "INT_TYPE",
                                            "value": "1",
                                            "type": "CONSTANT"
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "columnIdx": 0,
                                            "type": "VARIABLE"
                                        }
                                    }
                                ],
                                "opName": "MyriaApply(nowGroup=$0,iOrder=$1,mass=$2,type=$3,timestep=1,grp=$0)",
                                "opId": 1,
                                "opType": "Apply"
                            },
                            {
                                "opName": "MyriaScan(jortiz:testAstro:allTimestepsTest)",
                                "opId": 2,
                                "opType": "TableScan",
                                "relationKey": {
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro",
                                    "relationName": "allTimestepsPOI"
                                }
                            },
                            {
                                "opName": "MyriaUnionAll",
                                "opId": 3,
                                "opType": "UnionAll",
                                "argChildren": [
                                    2,
                                    1
                                ]
                            },
                            {
                                "argChild": 3,
                                "opId": 155,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "argOperatorId": 155,
                                "opId": 156,
                                "opType": "ShuffleConsumer"
                            },
                            {
                                "opName": "MyriaStore(public:adhoc:allTimestepsUnion)",
                                "relationKey": {
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro",
                                    "relationName": "allTimestepsUnion"
                                },
                                "argChild": 156,
                                "argOverwriteTable": true,
                                "opType": "DbInsert",
                                "opId": 4
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "fragments": [
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 1
                            },
                            {
                                "opId": 2,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 3
                            },
                            {
                                "argSelect1": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4,
                                    5,
                                    6
                                ],
                                "argSelect2": [
                                    0,
                                    1
                                ],
                                "argColumns1": [
                                    0
                                ],
                                "argColumns2": [
                                    0
                                ],
                                "opId": 4,
                                "argColumnNames": [
                                    "nowGroup",
                                    "timestep",
                                    "currentHalo",
                                    "nextHalo",
                                    "massSum",
                                    "sharedParticleCount",
                                    "sharedDark",
                                    "nowGroup1",
                                    "mass"
                                ],
                                "opName": "MyriaSymmetricHashJoin(($0 = $7); [$0, $1, $2, $3, $4, $5, $6, $7, $8])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "2",
                                "argChild2": "0"
                            },
                            {
                                "opId": 5,
                                "opName": "MyriaSelect(((($4 * 16420910.2142) / $8) > (1 / 1000)))",
                                "argChild": 4,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "GT",
                                        "left": {
                                            "type": "DIVIDE",
                                            "left": {
                                                "type": "TIMES",
                                                "left": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 4
                                                },
                                                "right": {
                                                    "type": "CONSTANT",
                                                    "value": "16420910.2142",
                                                    "valueType": "DOUBLE_TYPE"
                                                }
                                            },
                                            "right": {
                                                "type": "VARIABLE",
                                                "columnIdx": 8
                                            }
                                        },
                                        "right": {
                                            "type": "DIVIDE",
                                            "left": {
                                                "type": "CONSTANT",
                                                "value": "1",
                                                "valueType": "INT_TYPE"
                                            },
                                            "right": {
                                                "type": "CONSTANT",
                                                "value": "1000",
                                                "valueType": "INT_TYPE"
                                            }
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 6,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "currentHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "nextHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "sharedParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "sharedDark",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 6
                                        }
                                    }
                                ],
                                "argChild": 5,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,currentHalo=$2,nextHalo=$3,sharedParticleCount=$5,sharedDark=$6)"
                            },
                            {
                                "opId": 66,
                                "opName": "MyriaShuffleProducer(h($0))",
                                "argChild": 5,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 0,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 67,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 66
                            },
                            {
                                "opId": 69,
                                "opType": "InMemoryOrderBy",
                                "opName": "InMemSort(edges)",
                                "argChild": 67,
                                "argSortColumns": [
                                    0,
                                    1,
                                    3,
                                    4
                                ],
                                "argAscending": [
                                    true,
                                    true,
                                    true,
                                    false
                                ]
                            },
                            {
                                "relationKey": {
                                    "relationName": "edgesPreFilter",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opId": 70,
                                "argChild": 69,
                                "argOverwriteTable": true,
                                "opName": "MyriaStore(astro:mergerTreeCosmo50:edgesPreFilterTest)",
                                "opType": "DbInsert"
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 8,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 9
                            },
                            {
                                "argAggFields": [
                                    4,
                                    5,
                                    6
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 8,
                                "opId": 10,
                                "opName": "MyriaGroupBy($0,$1,$2,$3; SUM($4),SUM($5),SUM($6))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    3
                                ]
                            },
                            {
                                "opId": 11,
                                "opName": "MyriaSelect(((($6 > 64) and ($5 > 100)) and (($4 * 16420910.2142) > 100)))",
                                "argChild": 10,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "AND",
                                        "left": {
                                            "type": "AND",
                                            "left": {
                                                "type": "GT",
                                                "left": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 6
                                                },
                                                "right": {
                                                    "type": "CONSTANT",
                                                    "value": "64",
                                                    "valueType": "INT_TYPE"
                                                }
                                            },
                                            "right": {
                                                "type": "GT",
                                                "left": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 5
                                                },
                                                "right": {
                                                    "type": "CONSTANT",
                                                    "value": "100",
                                                    "valueType": "INT_TYPE"
                                                }
                                            }
                                        },
                                        "right": {
                                            "type": "GT",
                                            "left": {
                                                "type": "TIMES",
                                                "left": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 4
                                                },
                                                "right": {
                                                    "type": "CONSTANT",
                                                    "value": "16420910.2142",
                                                    "valueType": "DOUBLE_TYPE"
                                                }
                                            },
                                            "right": {
                                                "type": "CONSTANT",
                                                "value": "10",
                                                "valueType": "INT_TYPE"
                                            }
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 12,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "currentHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "nextHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "massSum",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "sharedParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "sharedDark",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 6
                                        }
                                    }
                                ],
                                "argChild": 11,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,currentHalo=$2,nextHalo=$3,massSum=$4,sharedParticleCount=$5,sharedDark=$6)"
                            },
                            {
                                "opId": 3,
                                "opName": "MyriaShuffleProducer(h($0))",
                                "argChild": 12,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 0,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 13,
                                "relationKey": {
                                    "relationName": "haloMass",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:haloMassTest)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 1,
                                "opName": "MyriaShuffleProducer(h($0))",
                                "argChild": 13,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 0,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 14,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 15
                            },
                            {
                                "opId": 16,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 17
                            },
                            {
                                "argSelect1": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4,
                                    5,
                                    6
                                ],
                                "argSelect2": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4,
                                    5,
                                    6
                                ],
                                "argColumns1": [
                                    1
                                ],
                                "argColumns2": [
                                    1
                                ],
                                "opId": 18,
                                "argColumnNames": [
                                    "nowGroup",
                                    "iOrder",
                                    "mass",
                                    "type",
                                    "timestep",
                                    "grp",
                                    "haloID",
                                    "nowGroup1",
                                    "iOrder1",
                                    "mass1",
                                    "type1",
                                    "timestep1",
                                    "grp1",
                                    "haloID1"
                                ],
                                "opName": "MyriaSymmetricHashJoin(($1 = $8); [$0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10, $11, $12, $13])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "16",
                                "argChild2": "14"
                            },
                            {
                                "opId": 19,
                                "opName": "MyriaSelect((($4 + 1) = $11))",
                                "argChild": 18,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "EQ",
                                        "left": {
                                            "type": "PLUS",
                                            "left": {
                                                "type": "VARIABLE",
                                                "columnIdx": 4
                                            },
                                            "right": {
                                                "type": "CONSTANT",
                                                "value": "1",
                                                "valueType": "INT_TYPE"
                                            }
                                        },
                                        "right": {
                                            "type": "VARIABLE",
                                            "columnIdx": 11
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 20,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "haloID",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 6
                                        }
                                    },
                                    {
                                        "outputName": "iOrder1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 8
                                        }
                                    },
                                    {
                                        "outputName": "mass1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 9
                                        }
                                    },
                                    {
                                        "outputName": "haloID1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 13
                                        }
                                    },
                                    {
                                        "outputName": "_COLUMN6_",
                                        "rootExpressionOperator": {
                                            "type": "CONDITION",
                                            "children": [
                                                {
                                                    "type": "EQ",
                                                    "left": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 10
                                                    },
                                                    "right": {
                                                        "type": "CONSTANT",
                                                        "value": "dark",
                                                        "valueType": "STRING_TYPE"
                                                    }
                                                },
                                                {
                                                    "type": "CONSTANT",
                                                    "value": "1",
                                                    "valueType": "INT_TYPE"
                                                },
                                                {
                                                    "type": "CONSTANT",
                                                    "value": "0",
                                                    "valueType": "INT_TYPE"
                                                }
                                            ]
                                        }
                                    }
                                ],
                                "argChild": 19,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$4,haloID=$6,iOrder1=$8,mass1=$9,haloID1=$13,_COLUMN6_=CASE(WHEN ($10 = \"dark\") THEN 1 ELSE 0))"
                            },
                            {
                                "argAggFields": [
                                    4,
                                    3,
                                    6
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_COUNT"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 20,
                                "opId": 21,
                                "opName": "MyriaGroupBy($0,$1,$2,$5; SUM($4),COUNT($3),SUM($6))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    5
                                ]
                            },
                            {
                                "opId": 9,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3))",
                                "argChild": 21,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 22,
                                "relationKey": {
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:timestepsPOITest)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 23,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "type",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "haloID",
                                        "rootExpressionOperator": {
                                            "type": "PLUS",
                                            "left": {
                                                "type": "TIMES",
                                                "left": {
                                                    "type": "PLUS",
                                                    "left": {
                                                        "type": "CONSTANT",
                                                        "value": "100",
                                                        "valueType": "INT_TYPE"
                                                    },
                                                    "right": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 4
                                                    }
                                                },
                                                "right": {
                                                    "type": "CONSTANT",
                                                    "value": "1000",
                                                    "valueType": "INT_TYPE"
                                                }
                                            },
                                            "right": {
                                                "type": "VARIABLE",
                                                "columnIdx": 5
                                            }
                                        }
                                    }
                                ],
                                "argChild": 22,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=nowGroup,iOrder=iOrder,mass=mass,type=type,timestep=timestep,grp=grp,haloID=(((100 + timestep) * 1000) + grp))"
                            },
                            {
                                "opId": 17,
                                "opName": "MyriaShuffleProducer(h($1))",
                                "argChild": 23,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 24,
                                "relationKey": {
                                    "relationName": "allTimestepsUnion",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:timestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 25,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "type",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "haloID",
                                        "rootExpressionOperator": {
                                            "type": "PLUS",
                                            "left": {
                                                "type": "TIMES",
                                                "left": {
                                                    "type": "PLUS",
                                                    "left": {
                                                        "type": "CONSTANT",
                                                        "value": "100",
                                                        "valueType": "INT_TYPE"
                                                    },
                                                    "right": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 4
                                                    }
                                                },
                                                "right": {
                                                    "type": "CONSTANT",
                                                    "value": "1000",
                                                    "valueType": "INT_TYPE"
                                                }
                                            },
                                            "right": {
                                                "type": "VARIABLE",
                                                "columnIdx": 5
                                            }
                                        }
                                    }
                                ],
                                "argChild": 24,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=nowGroup,iOrder=iOrder,mass=mass,type=type,timestep=timestep,grp=grp,haloID=(((100 + timestep) * 1000) + grp))"
                            },
                            {
                                "opId": 15,
                                "opName": "MyriaShuffleProducer(h($1))",
                                "argChild": 25,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "fragments": [
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "relationKey": {
                                    "relationName": "edgesPreFilter",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:edgesPreFilter)",
                                "opType": "TableScan"
                            },
                            {
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "currentHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "nextHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "sharedParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "nextHaloOrder",
                                        "rootExpressionOperator": {
                                            "type": "STATE",
                                            "columnIdx": 1
                                        }
                                    }
                                ],
                                "updaterExpressions": [
                                    {
                                        "outputName": "_grp__73",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "_rank__74",
                                        "rootExpressionOperator": {
                                            "type": "CONDITION",
                                            "children": [
                                                {
                                                    "type": "EQ",
                                                    "left": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 3
                                                    },
                                                    "right": {
                                                        "type": "STATE",
                                                        "columnIdx": 0
                                                    }
                                                },
                                                {
                                                    "type": "PLUS",
                                                    "left": {
                                                        "type": "STATE",
                                                        "columnIdx": 1
                                                    },
                                                    "right": {
                                                        "type": "CONSTANT",
                                                        "value": "1",
                                                        "valueType": "INT_TYPE"
                                                    }
                                                },
                                                {
                                                    "type": "CONSTANT",
                                                    "value": "1",
                                                    "valueType": "INT_TYPE"
                                                }
                                            ]
                                        }
                                    }
                                ],
                                "initializerExpressions": [
                                    {
                                        "outputName": "_grp__73",
                                        "rootExpressionOperator": {
                                            "type": "TIMES",
                                            "left": {
                                                "type": "CONSTANT",
                                                "value": "-1",
                                                "valueType": "INT_TYPE"
                                            },
                                            "right": {
                                                "type": "CONSTANT",
                                                "value": "1",
                                                "valueType": "INT_TYPE"
                                            }
                                        }
                                    },
                                    {
                                        "outputName": "_rank__74",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "0",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "opId": 1,
                                "argChild": 0,
                                "opName": "MyriaStatefulApply(nowGroup=$0,timestep=$1,currentHalo=$2,nextHalo=$3,sharedParticleCount=$4,nextHaloOrder=_rank__74)",
                                "opType": "StatefulApply"
                            },
                            {
                                "opId": 2,
                                "opName": "MyriaSelect(($5 = 1))",
                                "argChild": 1,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "EQ",
                                        "left": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        },
                                        "right": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 3,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "currentHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "nextHalo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "sharedParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    }
                                ],
                                "argChild": 2,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,currentHalo=$2,nextHalo=$3,sharedParticleCount=$4)"
                            },
                            {
                                "relationKey": {
                                    "relationName": "edgesSplit",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opId": 4,
                                "argChild": 3,
                                "argOverwriteTable": true,
                                "opName": "MyriaStore(astro:astroTest:edgesSplit)",
                                "opType": "DbInsert"
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "relationKey": {
                                    "relationName": "edgesSplit",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:astroTest:edgesSplit)",
                                "opType": "TableScan"
                            },
                            {
                                "relationKey": {
                                    "relationName": "edgesSplit",
                                    "programName": "__TEMP__",
                                    "userName": "public"
                                },
                                "opId": 1,
                                "argChild": 0,
                                "argOverwriteTable": true,
                                "opName": "StoreTemp(edgesSplit)",
                                "opType": "DbInsert"
                            }
                        ]
                    }
                ]
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "relationKey": {
                                    "relationName": "edgesSplit",
                                    "programName": "__TEMP__",
                                    "userName": "public"
                                },
                                "opName": "MyriaScanTemp(edgesSplit,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 1,
                                "opName": "MyriaSelect(($1 = 1))",
                                "argChild": 0,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "EQ",
                                        "left": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        },
                                        "right": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                }
                            },
                            {
                                "relationKey": {
                                    "relationName": "edgesNew",
                                    "programName": "__TEMP__",
                                    "userName": "public"
                                },
                                "opId": 2,
                                "argChild": 1,
                                "argOverwriteTable": true,
                                "opName": "StoreTemp(edgesNew)",
                                "opType": "DbInsert"
                            }
                        ]
                    }
                ]
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "opName": "SingletonRelation",
                                "opType": "Singleton"
                            },
                            {
                                "opId": 1,
                                "emitExpressions": [
                                    {
                                        "outputName": "i",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "argChild": 0,
                                "opType": "Apply",
                                "opName": "MyriaApply(i=1)"
                            },
                            {
                                "relationKey": {
                                    "relationName": "I",
                                    "programName": "__TEMP__",
                                    "userName": "public"
                                },
                                "opId": 2,
                                "argChild": 1,
                                "argOverwriteTable": true,
                                "opName": "StoreTemp(I)",
                                "opType": "DbInsert"
                            }
                        ]
                    }
                ]
            },
            {
                "type": "DoWhile",
                "condition": {
                    "relationName": "__dowhile_4537062736_condition",
                    "programName": "adhoc",
                    "userName": "public"
                },
                "body": [
                    {
                        "type": "SubQuery",
                        "fragments": [
                            {
                                "workers": [
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "operators": [
                                    {
                                        "opId": 0,
                                        "relationKey": {
                                            "relationName": "edgesNew",
                                            "programName": "__TEMP__",
                                            "userName": "public"
                                        },
                                        "opName": "MyriaScanTemp(edgesNew,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                        "opType": "TableScan"
                                    },
                                    {
                                        "opId": 1,
                                        "opName": "MyriaShuffleConsumer",
                                        "opType": "ShuffleConsumer",
                                        "argOperatorId": 2
                                    },
                                    {
                                        "opId": 3,
                                        "opName": "MyriaShuffleConsumer",
                                        "opType": "ShuffleConsumer",
                                        "argOperatorId": 4
                                    },
                                    {
                                        "argSelect1": [
                                            0,
                                            1,
                                            2,
                                            3,
                                            4,
                                            5,
                                            6,
                                            7,
                                            8,
                                            9
                                        ],
                                        "argSelect2": [
                                            0
                                        ],
                                        "argColumns1": [
                                            1
                                        ],
                                        "argColumns2": [
                                            0
                                        ],
                                        "opId": 5,
                                        "argColumnNames": [
                                            "nowGroup",
                                            "timestep",
                                            "currentHalo",
                                            "nextHalo",
                                            "sharedParticleCount",
                                            "nowGroup1",
                                            "timestep1",
                                            "currentHalo1",
                                            "nextHalo1",
                                            "sharedParticleCount1",
                                            "i"
                                        ],
                                        "opName": "MyriaSymmetricHashJoin(($1 = $10); [$0, $1, $2, $3, $4, $5, $6, $7, $8, $9, $10])",
                                        "opType": "SymmetricHashJoin",
                                        "argChild1": "3",
                                        "argChild2": "1"
                                    },
                                    {
                                        "opId": 6,
                                        "opName": "MyriaSelect(($6 = ($10 + 1)))",
                                        "argChild": 5,
                                        "opType": "Filter",
                                        "argPredicate": {
                                            "rootExpressionOperator": {
                                                "type": "EQ",
                                                "left": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 6
                                                },
                                                "right": {
                                                    "type": "PLUS",
                                                    "left": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 10
                                                    },
                                                    "right": {
                                                        "type": "CONSTANT",
                                                        "value": "1",
                                                        "valueType": "INT_TYPE"
                                                    }
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "opId": 7,
                                        "emitExpressions": [
                                            {
                                                "outputName": "nowGroup",
                                                "rootExpressionOperator": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 5
                                                }
                                            },
                                            {
                                                "outputName": "timestep",
                                                "rootExpressionOperator": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 6
                                                }
                                            },
                                            {
                                                "outputName": "currentHalo",
                                                "rootExpressionOperator": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 7
                                                }
                                            },
                                            {
                                                "outputName": "nextHalo",
                                                "rootExpressionOperator": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 8
                                                }
                                            },
                                            {
                                                "outputName": "sharedParticleCount",
                                                "rootExpressionOperator": {
                                                    "type": "VARIABLE",
                                                    "columnIdx": 9
                                                }
                                            }
                                        ],
                                        "argChild": 6,
                                        "opType": "Apply",
                                        "opName": "MyriaApply(nowGroup=$5,timestep=$6,currentHalo=$7,nextHalo=$8,sharedParticleCount=$9)"
                                    },
                                    {
                                        "opId": 8,
                                        "opName": "MyriaUnionAll",
                                        "opType": "UnionAll",
                                        "argChildren": [
                                            7,
                                            0
                                        ]
                                    },
                                    {
                                        "relationKey": {
                                            "relationName": "edgesNew",
                                            "programName": "__TEMP__",
                                            "userName": "public"
                                        },
                                        "opId": 9,
                                        "argChild": 8,
                                        "argOverwriteTable": true,
                                        "opName": "StoreTemp(edgesNew)",
                                        "opType": "DbInsert"
                                    }
                                ]
                            },
                            {
                                "workers": [
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "operators": [
                                    {
                                        "opId": 10,
                                        "opName": "MyriaShuffleConsumer",
                                        "opType": "ShuffleConsumer",
                                        "argOperatorId": 11
                                    },
                                    {
                                        "opId": 12,
                                        "opName": "MyriaShuffleConsumer",
                                        "opType": "ShuffleConsumer",
                                        "argOperatorId": 13
                                    },
                                    {
                                        "argSelect1": [
                                            0,
                                            1,
                                            2,
                                            3,
                                            4
                                        ],
                                        "argSelect2": [
                                            0,
                                            1,
                                            2,
                                            3,
                                            4
                                        ],
                                        "argColumns1": [
                                            0,
                                            3
                                        ],
                                        "argColumns2": [
                                            0,
                                            2
                                        ],
                                        "opId": 14,
                                        "argColumnNames": [
                                            "nowGroup",
                                            "timestep",
                                            "currentHalo",
                                            "nextHalo",
                                            "sharedParticleCount",
                                            "nowGroup1",
                                            "timestep1",
                                            "currentHalo1",
                                            "nextHalo1",
                                            "sharedParticleCount1"
                                        ],
                                        "opName": "MyriaSymmetricHashJoin((($0 = $5) and ($3 = $7)); [$0, $1, $2, $3, $4, $5, $6, $7, $8, $9])",
                                        "opType": "SymmetricHashJoin",
                                        "argChild1": "12",
                                        "argChild2": "10"
                                    },
                                    {
                                        "opId": 4,
                                        "opName": "MyriaShuffleProducer(h($1))",
                                        "argChild": 14,
                                        "opType": "ShuffleProducer",
                                        "argPf": {
                                            "index": 1,
                                            "type": "SingleFieldHash"
                                        }
                                    }
                                ]
                            },
                            {
                                "workers": [
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "operators": [
                                    {
                                        "opId": 15,
                                        "relationKey": {
                                            "relationName": "I",
                                            "programName": "__TEMP__",
                                            "userName": "public"
                                        },
                                        "opName": "MyriaScanTemp(I,[(u'i', 'LONG_TYPE')])",
                                        "opType": "TableScan"
                                    },
                                    {
                                        "opId": 2,
                                        "opName": "MyriaShuffleProducer(h($0))",
                                        "argChild": 15,
                                        "opType": "ShuffleProducer",
                                        "argPf": {
                                            "index": 0,
                                            "type": "SingleFieldHash"
                                        }
                                    }
                                ]
                            },
                            {
                                "workers": [
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "operators": [
                                    {
                                        "opId": 16,
                                        "relationKey": {
                                            "relationName": "edgesNew",
                                            "programName": "__TEMP__",
                                            "userName": "public"
                                        },
                                        "opName": "MyriaScanTemp(edgesNew,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                        "opType": "TableScan"
                                    },
                                    {
                                        "opId": 13,
                                        "opName": "MyriaShuffleProducer(h($0,$3))",
                                        "argChild": 16,
                                        "opType": "ShuffleProducer",
                                        "argPf": {
                                            "type": "MultiFieldHash",
                                            "indexes": [
                                                0,
                                                3
                                            ]
                                        }
                                    }
                                ]
                            },
                            {
                                "workers": [
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "operators": [
                                    {
                                        "opId": 17,
                                        "relationKey": {
                                            "relationName": "edgesSplit",
                                            "programName": "__TEMP__",
                                            "userName": "public"
                                        },
                                        "opName": "MyriaScanTemp(edgesSplit,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                        "opType": "TableScan"
                                    },
                                    {
                                        "opId": 11,
                                        "opName": "MyriaShuffleProducer(h($0,$2))",
                                        "argChild": 17,
                                        "opType": "ShuffleProducer",
                                        "argPf": {
                                            "type": "MultiFieldHash",
                                            "indexes": [
                                                0,
                                                2
                                            ]
                                        }
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "SubQuery",
                        "fragments": [
                            {
                                "workers": [
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "operators": [
                                    {
                                        "opId": 0,
                                        "relationKey": {
                                            "relationName": "I",
                                            "programName": "__TEMP__",
                                            "userName": "public"
                                        },
                                        "opName": "MyriaScanTemp(I,[(u'i', 'LONG_TYPE')])",
                                        "opType": "TableScan"
                                    },
                                    {
                                        "opId": 1,
                                        "emitExpressions": [
                                            {
                                                "outputName": "i",
                                                "rootExpressionOperator": {
                                                    "type": "PLUS",
                                                    "left": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 0
                                                    },
                                                    "right": {
                                                        "type": "CONSTANT",
                                                        "value": "1",
                                                        "valueType": "INT_TYPE"
                                                    }
                                                }
                                            }
                                        ],
                                        "argChild": 0,
                                        "opType": "Apply",
                                        "opName": "MyriaApply(i=(i + 1))"
                                    },
                                    {
                                        "relationKey": {
                                            "relationName": "I",
                                            "programName": "__TEMP__",
                                            "userName": "public"
                                        },
                                        "opId": 2,
                                        "argChild": 1,
                                        "argOverwriteTable": true,
                                        "opName": "StoreTemp(I)",
                                        "opType": "DbInsert"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "SubQuery",
                        "fragments": [
                            {
                                "operators": [
                                    {
                                        "opId": 0,
                                        "opName": "MyriaCollectConsumer",
                                        "opType": "CollectConsumer",
                                        "argOperatorId": 1
                                    },
                                    {
                                        "argAggFields": [
                                            0
                                        ],
                                        "argAggOperators": [
                                            [
                                                "AGG_OP_MIN"
                                            ]
                                        ],
                                        "argChild": 0,
                                        "opId": 2,
                                        "opName": "MyriaGroupBy(; MIN($0))",
                                        "opType": "Aggregate"
                                    },
                                    {
                                        "opId": 3,
                                        "emitExpressions": [
                                            {
                                                "outputName": "_COLUMN0_",
                                                "rootExpressionOperator": {
                                                    "type": "LTEQ",
                                                    "left": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 0
                                                    },
                                                    "right": {
                                                        "type": "CONSTANT",
                                                        "value": "10",
                                                        "valueType": "INT_TYPE"
                                                    }
                                                }
                                            }
                                        ],
                                        "argChild": 2,
                                        "opType": "Apply",
                                        "opName": "MyriaApply(_COLUMN0_=($0 <= 10))"
                                    },
                                    {
                                        "relationKey": {
                                            "relationName": "__dowhile_4537062736_condition",
                                            "programName": "adhoc",
                                            "userName": "public"
                                        },
                                        "opId": 4,
                                        "argChild": 3,
                                        "argOverwriteTable": true,
                                        "opName": "MyriaStore(public:adhoc:__dowhile_4537062736_condition)",
                                        "opType": "DbInsert"
                                    }
                                ]
                            },
                            {
                                "workers": [
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "operators": [
                                    {
                                        "opId": 5,
                                        "relationKey": {
                                            "relationName": "I",
                                            "programName": "__TEMP__",
                                            "userName": "public"
                                        },
                                        "opName": "MyriaScanTemp(I,[(u'i', 'LONG_TYPE')])",
                                        "opType": "TableScan"
                                    },
                                    {
                                        "argAggFields": [
                                            0
                                        ],
                                        "argAggOperators": [
                                            [
                                                "AGG_OP_MIN"
                                            ]
                                        ],
                                        "argChild": 5,
                                        "opId": 6,
                                        "opName": "MyriaGroupBy(; MIN($0))",
                                        "opType": "Aggregate"
                                    },
                                    {
                                        "opId": 1,
                                        "opName": "MyriaCollectProducer(@None)",
                                        "argChild": 6,
                                        "opType": "CollectProducer"
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "relationKey": {
                                    "relationName": "edgesNew",
                                    "programName": "__TEMP__",
                                    "userName": "public"
                                },
                                "opName": "MyriaScanTemp(edgesNew,[(u'nowGroup', 'LONG_TYPE'), (u'timestep', 'LONG_TYPE'), (u'currentHalo', 'LONG_TYPE'), (u'nextHalo', 'LONG_TYPE'), (u'sharedParticleCount', 'LONG_TYPE')])",
                                "opType": "TableScan"
                            },
                            {
                                "relationKey": {
                                    "relationName": "edgesChainFinal",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opId": 1,
                                "argChild": 0,
                                "argOverwriteTable": true,
                                "opName": "MyriaStore(astro:astroTest:edgesChain1)",
                                "opType": "DbInsert"
                            }
                        ]
                    }
                ]
            },
            {
                "fragments": [
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "opId": 0,
                                "argOperatorId": 1
                            },
                            {
                                "opName": "MyriaDupElim",
                                "opType": "DupElim",
                                "opId": 2,
                                "argChild": 0
                            },
                            {
                                "opType": "DbInsert",
                                "argChild": 2,
                                "opName": "MyriaStore(public:adhoc:DistinctFinalChain)",
                                "argOverwriteTable": true,
                                "opId": 3,
                                "relationKey": {
                                    "userName": "astro",
                                    "relationName": "DistinctFinalChain",
                                    "programName": "mergerTreeCosmo50"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "relationKey": {
                                    "userName": "astro",
                                    "relationName": "edgesChainFinal",
                                    "programName": "mergerTreeCosmo50"
                                },
                                "opType": "TableScan",
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:edgesChainFinal)",
                                "opId": 4
                            },
                            {
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3,$4))",
                                "opType": "ShuffleProducer",
                                "opId": 1,
                                "argChild": 4,
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3,
                                        4
                                    ]
                                }
                            }
                        ]
                    }
                ],
                "type": "SubQuery"
            },
            {
                "type": "SubQuery",
                "fragments": [
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 0,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 1
                            },
                            {
                                "argAggFields": [
                                    5
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_MAX"
                                    ]
                                ],
                                "argChild": 0,
                                "opId": 2,
                                "opName": "MyriaGroupBy($0,$1,$2,$3,$4; MAX($5))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4
                                ]
                            },
                            {
                                "opId": 3,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "halo",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "prog",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    }
                                ],
                                "argChild": 2,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,halo=$1,timestep=$2,mass=$3,totalParticleCount=$4,prog=$5)"
                            },
                            {
                                "relationKey": {
                                    "relationName": "haloTable",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opId": 4,
                                "argChild": 3,
                                "argOverwriteTable": true,
                                "opName": "MyriaStore(astro:mergerTreeCosmo50:haloTableTest)",
                                "opType": "DbInsert"
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 5,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 6
                            },
                            {
                                "opId": 7,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 8
                            },
                            {
                                "argSelect1": [
                                    0,
                                    1,
                                    2,
                                    3,
                                    4
                                ],
                                "argSelect2": [],
                                "argColumns1": [
                                    2,
                                    1,
                                    0
                                ],
                                "argColumns2": [
                                    1,
                                    2,
                                    0
                                ],
                                "opId": 9,
                                "argColumnNames": [
                                    "nowGroup",
                                    "grp",
                                    "timestep",
                                    "mass",
                                    "totalParticleCount"
                                ],
                                "opName": "MyriaSymmetricHashJoin(((($2 = $6) and ($1 = $7)) and ($0 = $5)); [$0, $1, $2, $3, $4])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "7",
                                "argChild2": "5"
                            },
                            {
                                "opId": 10,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "prog",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "argChild": 9,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,grp=$1,timestep=$2,mass=$3,totalParticleCount=$4,prog=1)"
                            },
                            {
                                "opId": 11,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 12
                            },
                            {
                                "argAggFields": [
                                    4,
                                    5
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 11,
                                "opId": 13,
                                "opName": "MyriaGroupBy($0,$1,$2,$3; SUM($4),SUM($5))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    3
                                ]
                            },
                            {
                                "opId": 14,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "prog",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    }
                                ],
                                "argChild": 13,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,grp=$1,timestep=$2,mass=$4,totalParticleCount=$5,prog=$3)"
                            },
                            {
                                "opId": 15,
                                "opName": "MyriaUnionAll",
                                "opType": "UnionAll",
                                "argChildren": [
                                    14,
                                    10
                                ]
                            },
                            {
                                "opId": 16,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "prog",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "_COLUMN5_",
                                        "rootExpressionOperator": {
                                            "type": "PLUS",
                                            "left": {
                                                "type": "TIMES",
                                                "left": {
                                                    "type": "PLUS",
                                                    "left": {
                                                        "type": "CONSTANT",
                                                        "value": "100",
                                                        "valueType": "INT_TYPE"
                                                    },
                                                    "right": {
                                                        "type": "VARIABLE",
                                                        "columnIdx": 2
                                                    }
                                                },
                                                "right": {
                                                    "type": "CONSTANT",
                                                    "value": "10000",
                                                    "valueType": "INT_TYPE"
                                                }
                                            },
                                            "right": {
                                                "type": "VARIABLE",
                                                "columnIdx": 1
                                            }
                                        }
                                    }
                                ],
                                "argChild": 15,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$2,mass=$3,totalParticleCount=$4,prog=$5,_COLUMN5_=(((100 + $2) * 10000) + $1))"
                            },
                            {
                                "argAggFields": [
                                    4
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_MAX"
                                    ]
                                ],
                                "argChild": 16,
                                "opId": 17,
                                "opName": "MyriaGroupBy($0,$5,$1,$2,$3; MAX($4))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    5,
                                    1,
                                    2,
                                    3
                                ]
                            },
                            {
                                "opId": 1,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3,$4))",
                                "argChild": 17,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3,
                                        4
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 18,
                                "relationKey": {
                                    "relationName": "allTimestepsPOI",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 19,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "_COLUMN4_",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "0",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "argChild": 18,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,mass=$2,timestep=$4,grp=$5,_COLUMN4_=0)"
                            },
                            {
                                "argAggFields": [
                                    1,
                                    0
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_COUNT"
                                    ]
                                ],
                                "argChild": 19,
                                "opId": 20,
                                "opName": "MyriaGroupBy($0,$3,$2,$4; SUM($1),COUNTALL)",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    3,
                                    2,
                                    4
                                ]
                            },
                            {
                                "opId": 12,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3))",
                                "argChild": 20,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 21,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 22
                            },
                            {
                                "argAggFields": [
                                    4,
                                    5
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 21,
                                "opId": 23,
                                "opName": "MyriaGroupBy($0,$1,$2,$3; SUM($4),SUM($5))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2,
                                    3
                                ]
                            },
                            {
                                "opId": 24,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "totalParticleCount",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    }
                                ],
                                "argChild": 23,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,grp=$1,timestep=$2,mass=$4,totalParticleCount=$5)"
                            },
                            {
                                "opId": 8,
                                "opName": "MyriaShuffleProducer(h($2,$1,$0))",
                                "argChild": 24,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        2,
                                        1,
                                        0
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 25,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 26
                            },
                            {
                                "opId": 27,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 28
                            },
                            {
                                "argSelect1": [
                                    0,
                                    1,
                                    2
                                ],
                                "argSelect2": [],
                                "argColumns1": [
                                    1,
                                    0,
                                    3
                                ],
                                "argColumns2": [
                                    1,
                                    0,
                                    2
                                ],
                                "opId": 29,
                                "argColumnNames": [
                                    "nowGroup",
                                    "timestep",
                                    "grp"
                                ],
                                "opName": "MyriaSymmetricHashJoin(((($1 = $5) and ($0 = $4)) and ($3 = $6)); [$0, $1, $2])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "27",
                                "argChild2": "25"
                            },
                            {
                                "opId": 30,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    }
                                ],
                                "argChild": 29,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,grp=$2)"
                            },
                            {
                                "opId": 6,
                                "opName": "MyriaShuffleProducer(h($1,$2,$0))",
                                "argChild": 30,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        1,
                                        2,
                                        0
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 31,
                                "relationKey": {
                                    "relationName": "allTimestepsPOI",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:timestepsPOITest)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 32,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "mass",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    },
                                    {
                                        "outputName": "_COLUMN4_",
                                        "rootExpressionOperator": {
                                            "type": "CONSTANT",
                                            "value": "0",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                ],
                                "argChild": 31,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,mass=$2,timestep=$4,grp=$5,_COLUMN4_=0)"
                            },
                            {
                                "argAggFields": [
                                    1,
                                    0
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ],
                                    [
                                        "AGG_OP_COUNT"
                                    ]
                                ],
                                "argChild": 32,
                                "opId": 33,
                                "opName": "MyriaGroupBy($0,$3,$2,$4; SUM($1),COUNTALL)",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    3,
                                    2,
                                    4
                                ]
                            },
                            {
                                "opId": 22,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2,$3))",
                                "argChild": 33,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2,
                                        3
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 34,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 35
                            },
                            {
                                "argAggFields": [
                                    3
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 34,
                                "opId": 36,
                                "opName": "MyriaGroupBy($0,$1,$2; SUM($3))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2
                                ]
                            },
                            {
                                "opId": 37,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    },
                                    {
                                        "outputName": "numShared",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    }
                                ],
                                "argChild": 36,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,grp=$2,numShared=$3)"
                            },
                            {
                                "opId": 28,
                                "opName": "MyriaShuffleProducer(h($1,$0,$3))",
                                "argChild": 37,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        1,
                                        0,
                                        3
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 38,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 39
                            },
                            {
                                "argAggFields": [
                                    2
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_MAX"
                                    ]
                                ],
                                "argChild": 38,
                                "opId": 40,
                                "opName": "MyriaGroupBy($0,$1; MAX($2))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1
                                ]
                            },
                            {
                                "opId": 41,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "maxShared",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    }
                                ],
                                "argChild": 40,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,maxShared=$2)"
                            },
                            {
                                "opId": 26,
                                "opName": "MyriaShuffleProducer(h($1,$0,$2))",
                                "argChild": 41,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        1,
                                        0,
                                        2
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 42,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 43
                            },
                            {
                                "opId": 44,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 45
                            },
                            {
                                "argSelect1": [
                                    0
                                ],
                                "argSelect2": [
                                    1,
                                    2
                                ],
                                "argColumns1": [
                                    1
                                ],
                                "argColumns2": [
                                    0
                                ],
                                "opId": 46,
                                "argColumnNames": [
                                    "nowGroup",
                                    "timestep",
                                    "grp"
                                ],
                                "opName": "MyriaSymmetricHashJoin(($1 = $2); [$0, $3, $4])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "44",
                                "argChild2": "42"
                            },
                            {
                                "opId": 47,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "grp1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    }
                                ],
                                "argChild": 46,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep1=$1,grp1=$2)"
                            },
                            {
                                "argAggFields": [
                                    0
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_COUNT"
                                    ]
                                ],
                                "argChild": 47,
                                "opId": 48,
                                "opName": "MyriaGroupBy($0,$1,$2; COUNTALL)",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2
                                ]
                            },
                            {
                                "opId": 35,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2))",
                                "argChild": 48,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 49,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 50
                            },
                            {
                                "argAggFields": [
                                    3
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_SUM"
                                    ]
                                ],
                                "argChild": 49,
                                "opId": 51,
                                "opName": "MyriaGroupBy($0,$1,$2; SUM($3))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2
                                ]
                            },
                            {
                                "opId": 52,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "numShared",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 3
                                        }
                                    }
                                ],
                                "argChild": 51,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep=$1,numShared=$3)"
                            },
                            {
                                "argAggFields": [
                                    2
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_MAX"
                                    ]
                                ],
                                "argChild": 52,
                                "opId": 53,
                                "opName": "MyriaGroupBy($0,$1; MAX($2))",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1
                                ]
                            },
                            {
                                "opId": 39,
                                "opName": "MyriaShuffleProducer(h($0,$1))",
                                "argChild": 53,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 54,
                                "relationKey": {
                                    "relationName": "allTimestepsPOI",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 55,
                                "opName": "MyriaSelect(($4 = 1))",
                                "argChild": 54,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "EQ",
                                        "left": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        },
                                        "right": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 56,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    }
                                ],
                                "argChild": 55,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,iOrder=$1)"
                            },
                            {
                                "opId": 45,
                                "opName": "MyriaShuffleProducer(h($1))",
                                "argChild": 56,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 57,
                                "relationKey": {
                                    "relationName": "allTimestepsPOI",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 58,
                                "emitExpressions": [
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    }
                                ],
                                "argChild": 57,
                                "opType": "Apply",
                                "opName": "MyriaApply(iOrder=$1,timestep=$4,grp=$5)"
                            },
                            {
                                "opId": 43,
                                "opName": "MyriaShuffleProducer(h($0))",
                                "argChild": 58,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 0,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 59,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 60
                            },
                            {
                                "opId": 61,
                                "opName": "MyriaShuffleConsumer",
                                "opType": "ShuffleConsumer",
                                "argOperatorId": 62
                            },
                            {
                                "argSelect1": [
                                    0
                                ],
                                "argSelect2": [
                                    1,
                                    2
                                ],
                                "argColumns1": [
                                    1
                                ],
                                "argColumns2": [
                                    0
                                ],
                                "opId": 63,
                                "argColumnNames": [
                                    "nowGroup",
                                    "timestep",
                                    "grp"
                                ],
                                "opName": "MyriaSymmetricHashJoin(($1 = $2); [$0, $3, $4])",
                                "opType": "SymmetricHashJoin",
                                "argChild1": "61",
                                "argChild2": "59"
                            },
                            {
                                "opId": 64,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "timestep1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "grp1",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 2
                                        }
                                    }
                                ],
                                "argChild": 63,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,timestep1=$1,grp1=$2)"
                            },
                            {
                                "argAggFields": [
                                    0
                                ],
                                "argAggOperators": [
                                    [
                                        "AGG_OP_COUNT"
                                    ]
                                ],
                                "argChild": 64,
                                "opId": 65,
                                "opName": "MyriaGroupBy($0,$1,$2; COUNTALL)",
                                "opType": "MultiGroupByAggregate",
                                "argGroupFields": [
                                    0,
                                    1,
                                    2
                                ]
                            },
                            {
                                "opId": 50,
                                "opName": "MyriaShuffleProducer(h($0,$1,$2))",
                                "argChild": 65,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "type": "MultiFieldHash",
                                    "indexes": [
                                        0,
                                        1,
                                        2
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 66,
                                "relationKey": {
                                    "relationName": "allTimestepsPOI",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 67,
                                "opName": "MyriaSelect(($4 = 1))",
                                "argChild": 66,
                                "opType": "Filter",
                                "argPredicate": {
                                    "rootExpressionOperator": {
                                        "type": "EQ",
                                        "left": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        },
                                        "right": {
                                            "type": "CONSTANT",
                                            "value": "1",
                                            "valueType": "INT_TYPE"
                                        }
                                    }
                                }
                            },
                            {
                                "opId": 68,
                                "emitExpressions": [
                                    {
                                        "outputName": "nowGroup",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 0
                                        }
                                    },
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    }
                                ],
                                "argChild": 67,
                                "opType": "Apply",
                                "opName": "MyriaApply(nowGroup=$0,iOrder=$1)"
                            },
                            {
                                "opId": 62,
                                "opName": "MyriaShuffleProducer(h($1))",
                                "argChild": 68,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 1,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    },
                    {
                        "workers": [
                            1,
                            2,
                            3,
                            4
                        ],
                        "operators": [
                            {
                                "opId": 69,
                                "relationKey": {
                                    "relationName": "allTimestepsPOI",
                                    "programName": "mergerTreeCosmo50",
                                    "userName": "astro"
                                },
                                "opName": "MyriaScan(astro:mergerTreeCosmo50:allTimestepsPOI)",
                                "opType": "TableScan"
                            },
                            {
                                "opId": 70,
                                "emitExpressions": [
                                    {
                                        "outputName": "iOrder",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 1
                                        }
                                    },
                                    {
                                        "outputName": "timestep",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 4
                                        }
                                    },
                                    {
                                        "outputName": "grp",
                                        "rootExpressionOperator": {
                                            "type": "VARIABLE",
                                            "columnIdx": 5
                                        }
                                    }
                                ],
                                "argChild": 69,
                                "opType": "Apply",
                                "opName": "MyriaApply(iOrder=$1,timestep=$4,grp=$5)"
                            },
                            {
                                "opId": 60,
                                "opName": "MyriaShuffleProducer(h($0))",
                                "argChild": 70,
                                "opType": "ShuffleProducer",
                                "argPf": {
                                    "index": 0,
                                    "type": "SingleFieldHash"
                                }
                            }
                        ]
                    }
                ]
            }
        ]
    },
    "rawDatalog": "scriptFor10Timesteps"
}